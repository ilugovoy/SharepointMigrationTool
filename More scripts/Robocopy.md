# Robocopy

## Команда для копирования несколькоих папок
```ps1
$sourceBase = "E:\Migration1\YOUR_FOLDER"
$destinationBase = "M:\MigrationMaster\YOUR_FOLDER"

$folders = @(
"Site1 - Style Library"
)

foreach ($folder in $folders) {
    $source = Join-Path -Path $sourceBase -ChildPath $folder
    $destination = Join-Path -Path $destinationBase -ChildPath $folder
    robocopy $source $destination /MIR /MT:20 /R:3 /W:1 /REG
}
```

## Ключи Robocopy

| Ключ               | Описание                                                                 |
|---------------------|-------------------------------------------------------------------------|
| `/XO`              | Исключает файлы, которые старше (или такие же по дате изменения) в целевой папке по сравнению с исходной. |
| `/XN`              | Исключает файлы, которые новее в целевой папке по сравнению с исходной. |
| `/XC`              | Исключает файлы, которые уже есть в целевой папке, независимо от их даты изменения. |
| `/MT:N`            | Использует многопоточность (N потоков). Например, `/MT:20` для 20 потоков. |
| `/R:N`             | Количество повторных попыток при ошибках (N попыток). Например, `/R:3` для 3 попыток. |
| `/W:N`             | Время ожидания между попытками (N секунд). Например, `/W:1` для 1 секунды. |
| `/REG`             | Сохраняет параметры в реестре для последующих запусков.                 |
| `/MIR`             | ЗИспользуйте параметр /MIR (зеркалирование), чтобы принудительно синхронизировать исходную и целевую директории. Это удалит файлы в целевой директории, которых нет в исходной, и перезапишет существующие файлы. |
| `/LOG+:путь_к_файлу_лога.txt` | Выводит подробный лог в указанный файл. Если файл существует, лог будет добавлен в конец. |
| `/E`               | Копирует все подкаталоги, включая пустые.                              |
| `/B`               | Резервный режим. Игнорирует ошибки доступа.                            |


## Примеры использования

### Копирование только отсутствующих файлов
```cmd
robocopy "C:\Source" "D:\Destination" /XC /MT:20 /R:3 /W:1 /REG
```

### Зеркалирование папок
```cmd
robocopy "C:\Source" "D:\Destination" /MIR /MT:20 /R:3 /W:1 /REG
```

### Копирование с логом
```cmd
robocopy "C:\Source" "D:\Destination" /LOG+:C:\logs\robocopy.log /MT:20 /R:3 /W:1 /REG
```

### Копирование с игнорированием ошибок доступа
```cmd
robocopy "C:\Source" "D:\Destination" /B /MT:20 /R:3 /W:1 /REG
```